#!/usr/bin/bash

repo_url=$(git config --get remote.origin.url)

if [ -z "$1" ]; then
    echo "‚ö†Ô∏è  Aucun message de commit fourni."
    read -p "Veuillez entrer un message de commit : " commit
else
    commit="$1"
fi

echo "üìÇ Ajout des fichiers au suivi Git..."
git add . > /dev/null 2>&1

echo "üìù Cr√©ation du commit avec le message : '$commit'"
git commit -m "$commit" > /dev/null 2>&1

echo "üöÄ Envoi des modifications vers le d√©p√¥t distant..."
git push > /dev/null 2>&1

# V√©rifie si l'URL existe
if [ -n "$repo_url" ]; then
    # Si l'URL est en format SSH, la convertir en HTTPS
    if [[ "$repo_url" == git@* ]]; then
        repo_url=$(echo "$repo_url" | sed -E 's|git@(.*):|https://\1/|' | sed 's|\.git$||')
    fi

    echo "üåê Ouverture du d√©p√¥t dans le navigateur : $repo_url"
    xdg-open "$repo_url" > /dev/null 2>&1
else
    echo "‚ùå Impossible de r√©cup√©rer l'URL du d√©p√¥t distant."
fi

echo "‚úÖ Op√©ration termin√©e avec succ√®s !"